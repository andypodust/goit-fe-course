"use strict";var refs={template:document.querySelector(".js-template"),listCards:document.querySelector(".js-list-cards"),input:document.querySelector(".js-form input[type=text]"),form:document.querySelector(".js-form")},source=refs.template.innerHTML.trim(),temp=Handlebars.compile(source);function handleFormSubmit(e){e.preventDefault();if(!/^((ftp|http|https):\/\/)?(www\.|)([A-z|0-9]+)\.([A-z]{2,})/.test(refs.input.value))return refs.input.parentNode.reset(),alert("Невалидный URL! Попробуйте еще раз.");fetch("https://api.linkpreview.net/?key=5bd2be4683f4df4868c2be896cecac30712acbad1b051=".concat(refs.input.value)).then(function(e){if(e.ok)return e.json()}).then(function(e){if(null!==localStorage.getItem(e.url))return alert("Такая закладка уже есть!");localStorage.setItem(e.url,e.url);var t=temp(e);refs.listCards.insertAdjacentHTML("afterbegin",t)}).catch(function(e){return console.error(e)}),refs.input.parentNode.reset()}function handleDelBtn(e){e.preventDefault();var t=document.querySelector(".js-li-url");"BUTTON"===e.target.nodeName&&(localStorage.removeItem(t.name),e.target.parentElement.parentElement.remove())}Object.keys(localStorage).forEach(function(e){fetch("https://api.linkpreview.net/?key=5bd2be4683f4df4868c2be896cecac30712acbad1b051=".concat(e)).then(function(e){if(e.ok)return e.json()}).then(function(e){refs.listCards.insertAdjacentHTML("afterbegin",temp(e))}).catch(function(e){return console.error(e)})}),refs.form.addEventListener("submit",handleFormSubmit),refs.listCards.addEventListener("click",handleDelBtn);